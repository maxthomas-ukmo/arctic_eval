# ESMValTool
# recipe_arctic_ocean.yml
---
documentation:
  title: Arctic Ocean Diagnostics
  description: |
    Arctic Ocean diagnostics.

  authors:
    - koldunov_nikolay

  maintainer:
    - koldunov_nikolay

  references:
    - contact_authors

  projects:
    - trr181
    - applicate

# Model problems
datasets:
  - {dataset: HadGEM3-GC31-LL, project: CMIP6, grid: gn}
  - {dataset: HadGEM3-GC31-MM, project: CMIP6, grid: gn}
#  - {dataset: HadGEM3-GC31-LL, project: CMIP6, mip: Omon, exp: historical, ensemble: r1i1p1f3, grid: gn}
#  - {dataset: HadGEM3-GC31-MM, project: CMIP6, mip: SImon, exp: historical, ensemble: r*i1p1f3, grid: gn}


preprocessors:

  extract_whole_arctic: &extract_whole_arctic_preprocessor
    extract_region: 
      start_longitude: 0
      end_longitude: 360
      start_latitude: 65
      end_latitude: 90

  arctic_ensemble_mean:
    <<: *extract_whole_arctic_preprocessor
    multi_model_statistics: # Deosn't work with multiple members yet. need to add aliases to loader
      span: full
      statistics: [mean]
      groupby: [dataset]

  BSF_testing:
    extract_region:
      start_longitude: 0
      end_longitude: 360
      start_latitude: -90
      end_latitude: 0
    regrid:
      target_grid: 1x1
      scheme: linear
      
      
diagnostics:  
  strait_flux:
    description: strait flux testing
    variables: 
      vo: &variables
        preprocessor: arctic_ensemble_mean
        mip: Omon
        start_year: 1979
        end_year: 1981
        exp: historical 
        ensemble: r1i1p1f3
      uo: *variables
      thetao: *variables
      thkcello: *variables
      so: *variables
      areacello:
        preprocessor: extract_whole_arctic
        mip: Ofx
        exp: piControl
        ensemble: r1i1p1f1
    scripts:
      strait_flux:
        script: ~/arctic_eval/code/diag_scripts/arctic_eval.py
        plot_type: [crosssection, timeseries]
        dummy_plot: False
        time_start: 1979-01 # These are needed here to pass to the strait flux functions and must match the preprocessing
        time_end: 1981-12
        model_datasets: [HadGEM3-GC31-LL, HadGEM3-GC31-MM]
        # strait: [Fram, Barents, Bering, Hudson, Hudson_NW, Färöer, IF, FS, OSNAP, GSR, NIIC]
        strait: [Fram, Barents, Bering] # Not working with -LL: Hudson, Hudson_NW, IF, Färöer, FS
        strait_depths: # Depths for the straits in meters
          Fram: 4000
          Barents: 500
          Bering: 50
        product_cmaps:
          heat: seismic
          salt: copper
          volume: brewer_PiYG_11
        include_salinity: True
  
    